(defwidget workspaces []
  (eventbox :onscroll "bash ~/.config/eww/scripts/change-active-workspace {} ${current_workspace}" :class "workspaces-widget"
    (box :space-evenly false :spacing 5
      (label :text "${workspaces}${current_workspace}" :visible false)
      (for workspace in workspaces
        (eventbox :onclick "hyprctl dispatch workspace ${workspace.id}"
          (box :class "workspace-entry ${workspace.windows > 0 ? "occupied" : "empty"}"
            (label :text "${workspace.id}" :class "workspace-entry ${workspace.id == current_workspace ? "current" : ""}" )
            )
          )
        )
      )
    )
  )

(defwidget title []
  (box
    (label :text "${window}" :class "title"
    )
  )
)

(defwidget seperator []
  (box
    (label :text "|" :class "seperator"
    )
  )
)

(defwidget clock []
  (box
    :class "time"
    :halign "end"
    :orientation "h"
    (box
      (label
        :class "bar-time"
        :text "${hour}:${minute} ${period}"
      )
    )
  )
)

(defwidget speakers []
    (box :class "speakers"
      :space-evenly false
      :spacing 5
      (button :class "icon ${ speakers.volume > 100 ? 'over' : '' } ${ speakers.muted ? 'muted' : '' }"
        :onclick "bash -e '~/.config/eww/scripts/pavucontrol.sh'"
        :onrightclick "pactl set-sink-mute @DEFAULT_SINK@ toggle"
        (label :text {
          speakers.muted ? "󰖁 ${speakers.volume}%":
          speakers.volume == 0 ? "󰕿 ${speakers.volume}%":
          speakers.volume < 33 ? "󰖀 ${speakers.volume}%":
          "󰕾 ${speakers.volume}%"
        }))
    )
)


(defwidget battery []
    (box :class "battery icon-battery"
        :space-evenly false
        :spacing 5
        (label
            :class "${battery.status == 'Charging' ? 'charging' : ''}"
            :text {
                battery.status == "Charging" ?
                    (battery.percentage > 90 ? "󰂄" :
                     battery.percentage > 70 ? "󰂌" :
                     battery.percentage > 50 ? "󰂇" :
                     battery.percentage > 20 ? "󰂆" : "󰂆") :
                    (battery.percentage > 90 ? "󰁹" :
                     battery.percentage > 80 ? "󰂀" :
                     battery.percentage > 60 ? "󰁿" :
                     battery.percentage > 40 ? "󰁼" :
                     battery.percentage > 20 ? "󰁺" :
                     battery.percentage > 10 ? "󰂎" : "󰂎")
            }
            :tooltip "${battery.percentage}% - ${battery.status}"
        )
        (label
            :text "${battery.percentage}%"
            :class "battery-percentage"
        )
    )
)

(defwidget brightness []
    (box :class "brightness"
        :space-evenly false
        :spacing 5
        (button
            :class "icon-brightness ${brightness.brightness > 100 ? 'over' : ''}"
            :onclick "brightnessctl set 5%+ && brightnessctl get"
            :onrightclick "brightnessctl set 5%- && brightnessctl get"
            (label
                :text {
                    brightness.brightness == 0 ? "󰄰 0%" :
                    brightness.brightness < 10 ? "󰪞 ${brightness.brightness}%" :
                    brightness.brightness < 25 ? "󰪟 ${brightness.brightness}%" :
                    brightness.brightness < 40 ? "󰪠 ${brightness.brightness}%" :
                    brightness.brightness < 60 ? "󰪢 ${brightness.brightness}%" :
                    brightness.brightness < 76 ? "󰪣 ${brightness.brightness}%" :
                    brightness.brightness < 90 ? "󰪤 ${brightness.brightness}%" :
                    "󰪥 ${brightness.brightness}%"
                }
            )
        )
    )
)

(defwidget noti-button []
  (eventbox
    :onclick "sh ~/.config/eww/scripts/swaync.sh"
    :cursor "pointer"
    (box :class "powerButton"
      (label
        :text " 󰂚 "
      )
    )
  )
)


(defwidget time []
  (eventbox
    :cursor "pointer"
    (box
      :class ""
      (clock)
    )
  )
)

(defwidget tray []
	(systray
		:spacing 8
		:orientation "h"
		:icon-size 12
		:prepend-new true
	)
)


(defwidget left []
   (box
     :class "ccButton"
     :halign "start"
     :valign "center"
     :space-evenly false
     :spacing 10
     (eventbox
        :onclick "sh ~/.config/eww/scripts/toggleLauncher"
        :onhover ""
        :cursor "pointer"
        (label
          :text " 󰣇 "
        )
      )
    (seperator)
    (title)
    )
)

(defwidget center []
  (box
    :class ""
    :halign "center"
    :valign "center"
    :orientation "h"
    :space-evenly false
    (workspaces)

  )
)

(defwidget right []
  (box
    :class ""
    :orientation "h"
    :space-evenly false
    :spacing 10
    :halign "end"
    :valign "center"
    (tray)
    (seperator)
    (battery)
    (brightness)
    (speakers)
    (seperator)
    (time)
    (seperator)
    (noti-button)
  )
)



(defwidget bar []
  (centerbox
     :class "bar"
     :orientation "h"
     (left)
     (center)
     (right)
   )
)
