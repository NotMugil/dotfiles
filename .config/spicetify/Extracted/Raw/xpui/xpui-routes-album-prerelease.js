"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[8865],{9618:(e,r,t)=>{t.d(r,{p:()=>m});var n=t(29969),a=t(52618),i=t.n(a),l=t(30758),o=t(41978),u=t(49599),s=t(86461),c=t(90577),d=t(55937),v=t(53634),f=t(86070),m=l.memo((function(e){var r=e.uri,t=e.divider,a=e.removeLabel,m=(0,o.wA)(),p=!(0,c.n)(),h=(0,d.t)(),x=(0,l.useCallback)((0,n.A)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m((0,v.aw)(r,!0));case 1:case"end":return e.stop()}}),e)}))),[m,r]);return(0,f.jsx)(s.D,{role:"menuitem",divider:t,disabled:p&&!(null!=h&&h.getCapabilities().canModifyOffline),onClick:x,leadingIcon:(0,f.jsx)(u.k,{semanticColor:"textBrightAccent",size:"small"}),children:a})}))},34709:(e,r,t)=>{t.d(r,{P:()=>h});var n=t(30758),a=t(8539),i=t(25931),l=t(93697),o=t(38586),u=t(42021),s=t(22058),c=t(16443),d=t(61098),v=t(85368),f=t(53e3),m=t(9618),p=t(86070),h=n.memo((function(e){var r=e.uri,t=e.artistUri,n=e.canPin,h=void 0===n?o.oT.NO:n,x=e.isPinned,y=void 0!==x&&x,b=e.canRemove,g=void 0!==b&&b,k=(0,u.o)(r).spec;return(0,p.jsx)(l.pZ,{value:"album",children:(0,p.jsxs)(i.W,{children:[g&&(0,p.jsx)(m.p,{uri:r,removeLabel:a.Ru.get("contextmenu.remove-from-library")}),t&&(0,p.jsx)(d.z,{spec:k,divider:"after",uri:t,displayText:a.Ru.get("contextmenu.go-to-artist-radio")}),h!==o.oT.NO&&(0,p.jsx)(f.k,{uri:r,canPin:h,isPinned:y,type:s.c.PRE_RELEASE_ALBUM,spec:k}),(0,p.jsx)(c.m,{uri:r,spec:k,displayText:a.Ru.get("context-menu.copy-album-link")}),(0,p.jsx)(v.q,{spec:k,divider:"before",uri:r})]})})}))},75928:(e,r,t)=>{t.r(r),t.d(r,{AlbumPrerelease:()=>Re});t(9555),t(45191),t(83603),t(45803),t(62980),t(14053),t(11034),t(36389),t(12771),t(75231),t(21977),t(76133),t(77020),t(45935),t(60726),t(82765),t(13312);var n=t(97500),a=t.n(n),i=t(33165),l=t(58184),o=t(96839),u=t(8539),s=t(5125),c=t(60093),d=t(22058),v=t(94999),f=t(82342),m=t(57528),p=t(537),h=(t(59208),t(2944),t(42078),t(40313),t(24847),t(59433),t(82368),t(52165),t(20767),t(20427),t(65083),t(47246),t(58470),t(30758)),x=t(67281),y=t(42344),b=new x.l("albumPreRelease","query","cb7e121ae0c2d105ea9a8a5c8a003e520f333e0e94073032dcdbd548dd205d66",null),g=function(e,r){return(0,y.I)(b,e,r)},k=t(29969),j=t(52618),A=t.n(j),R=t(48433),C=t(64526),w=new x.l("albumPreReleaseTracks","query","dfbdcf2688995adc2c2196fcdd7802b2a5137a2549b361aa7fb23cd6493f4672",null);function P(e,r){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,r){if(e){if("string"==typeof e)return I(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?I(e,r):void 0}}(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,o=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return l=e.done,e},e:function(e){o=!0,i=e},f:function(){try{l||null==t.return||t.return()}finally{if(o)throw i}}}}function I(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}var T={totalLength:0,items:[]};function S(e){var r,t=e.preReleaseContent,n=[];if(null!=t&&t.tracks){var a,i=P(t.tracks.items);try{for(i.s();!(a=i.n()).done;){var l,o,u,s,c=a.value;n.push({uri:c.uri,name:c.name?c.name:"",isPlayable:c.playability.playable,durationMs:null!==(l=null===(o=c.duration)||void 0===o?void 0:o.totalMilliseconds)&&void 0!==l?l:0,hasOriginalAudio:c.hasOriginalAudio,artists:_(c.artists.items),isExplicit:(null===(u=c.contentRating)||void 0===u?void 0:u.label)===C.x7.Explicit,is19PlusOnly:(null===(s=c.contentRating)||void 0===s?void 0:s.label)===C.x7.NineteenPlus})}}catch(e){i.e(e)}finally{i.f()}}return{totalLength:null!==(r=null==t?void 0:t.tracks.totalCount)&&void 0!==r?r:0,items:n}}function _(e){var r,t=[],n=P(e);try{for(n.s();!(r=n.n()).done;){var a=r.value;"Artist"===a.data.__typename&&t.push({name:a.data.profile.name,uri:a.data.uri})}}catch(e){n.e(e)}finally{n.f()}return t}function E(e,r){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,r){if(e){if("string"==typeof e)return L(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?L(e,r):void 0}}(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,o=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return l=e.done,e},e:function(e){o=!0,i=e},f:function(){try{l||null==t.return||t.return()}finally{if(o)throw i}}}}function L(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}function U(e){return e.includes("â„—")?{type:"P",text:e}:{type:"C",text:e}}function D(e){var r,t,n=e.preReleaseContent,a=void 0;if(n){var i,l,o,u,s,c,d=S(e);a={artists:M(n.artists.items),name:null!==(i=n.name)&&void 0!==i?i:void 0,uri:n.uri,coverArt:{extractedColors:null===(l=n.coverArt)||void 0===l||null===(l=l.extractedColors)||void 0===l?void 0:l.colorRaw,sources:null!==(o=null===(u=n.coverArt)||void 0===u?void 0:u.sources)&&void 0!==o?o:[]},type:n.type,tracks:d,copyrights:null!==(s=null===(c=n.copyright)||void 0===c?void 0:c.split("\n").map(U))&&void 0!==s?s:[]}}return{uri:e.uri,releaseDate:null===(r=e.releaseDate)||void 0===r?void 0:r.isoString,timezone:null!==(t=e.timezone)&&void 0!==t?t:void 0,content:a}}function M(e){var r,t=[],n=E(e);try{for(n.s();!(r=n.n()).done;){var a,i,l=r.value;if("Artist"===l.data.__typename)t.push({name:l.data.profile.name,id:l.data.id,uri:l.data.uri,images:null!==(a=null===(i=l.data.visuals.avatarImage)||void 0===i?void 0:i.sources)&&void 0!==a?a:[]})}}catch(e){n.e(e)}finally{n.f()}return t}var N=t(96331),z=t(98866),O=(t(60418),t(17834)),B=t(93239),F=t(58400),$=t(10139),W=t(93655),G=t(45782),H=t(34709),K=t(25287),q=t(44671),X=t(95477),Z=t(93813),Y=t(86070),Q=function(e){var r=e.uri,t=(0,Z.V)(r),n=(0,F.r)(O.k,{data:{uri:r||""}}),a=n.spec,i=n.logger,l=(0,h.useCallback)((function(){r&&(i.logInteraction(a.actionBarFactory().preSaveButtonFactory().hitUiNavigate({destination:r})),t())}),[t,a,r,i]);return r?(0,Y.jsx)(X.$,{onClick:l,children:u.Ru.get("web-player.prerelease.listen_now")}):null},V=function(e){var r,t,n,a=e.prerelease,i=e.backgroundColor,l=function(e){var r=(0,h.useState)((function(){return!!e&&(0,v.u)(e)<=0})),t=(0,z.A)(r,2),n=t[0],a=t[1];return(0,h.useEffect)((function(){if(e){var r=(0,v.u)(e);if(r<=0)a(!0);else{if(!(r>=36e5)){var t=setTimeout((function(){a(!0)}),r);return function(){clearTimeout(t)}}a(!1)}}}),[e]),n}(a.releaseDate),o=(0,F.r)(O.k,{data:{uri:a.uri}}),s=o.spec,c=o.UBIFragment,d=(0,q.j)();return(0,Y.jsx)($.E,{backgroundColor:i,children:(0,Y.jsxs)(W.S,{children:[l?(0,Y.jsx)(Q,{uri:null===(r=a.content)||void 0===r?void 0:r.uri}):(0,Y.jsx)(K.v,{uri:a.uri}),(0,Y.jsx)(c,{spec:s,children:(0,Y.jsx)(B.b,{menu:(0,Y.jsx)(H.P,{uri:a.uri,artistUri:null===(t=a.content)||void 0===t?void 0:t.artists[0].uri}),children:(0,Y.jsx)(G.e,{label:u.Ru.get("more.label.context",null===(n=a.content)||void 0===n?void 0:n.name),size:d})})})]})})};var J=t(87349),ee=t(86001),re=t(17893),te=t(64166),ne=t(22043),ae=t(18520),ie=t(51414),le=t(66932),oe=t(64741),ue=t(79851),se=t(7138),ce=t(50629),de=t(74460);const ve="LFDgGRo4wD273tY6cKQ0";var fe=function(e){var r,t=e.prerelease,n=e.children;return(0,Y.jsx)(J.h,{menu:(0,Y.jsx)(H.P,{uri:t.uri,artistUri:null===(r=t.content)||void 0===r?void 0:r.artists[0].uri}),children:n})},me=function(e){var r,t=e.prerelease,n=e.backgroundColor,a=t.content,i=t.releaseDate,l=(0,re.y)(),o=l===ee.E.SMALL||l===ee.E.XSMALL,u=(0,F.r)(O.k,{data:{uri:t.uri}}),s=u.spec,c=u.logger,d=(0,h.useCallback)((function(e,r){if(s){var t=s.headerFactory().artistNameFactory().hitUiNavigate({destination:r.creator.uri});c.logInteraction(t)}}),[c,s]),v=a,f=(0,h.useMemo)((function(){return i?new Date(i):void 0}),[i]);return(0,Y.jsxs)(ae.z,{backgroundColor:n,size:ae.K.LARGE,children:[(0,Y.jsx)(oe.h,{children:v.name?(0,Y.jsx)(fe,{prerelease:t,children:(0,Y.jsx)(ue.X,{text:v.name})}):null}),!o&&(0,Y.jsx)(fe,{prerelease:t,children:(0,Y.jsx)(ie.K,{images:v.coverArt.sources,name:null!==(r=v.name)&&void 0!==r?r:"",placeholderType:"album"})}),(0,Y.jsxs)(le.Y,{children:[(0,Y.jsx)(ce.B,{children:(0,te.C)(v.type)}),(0,Y.jsx)(fe,{prerelease:t,children:(0,Y.jsx)(de.mm,{scaleAtMinWidth:de.Cl,children:v.name})}),(0,Y.jsx)(se.t,{creators:v.artists,onCreatorClick:d,releaseDate:i,timeZone:t.timezone}),f&&v.name?(0,Y.jsx)(ne.G,{images:o?v.coverArt.sources:[],className:ve,imageTitle:v.name,targetDate:f}):null]})]})},pe=(t(63763),t(83875)),he=t(94541),xe=t(6024),ye=t(58212),be=t(49294),ge=[he.$.INDEX,he.$.TITLE_AND_ARTIST,he.$.DURATION],ke=(0,h.memo)((function(e){var r=e.ariaLabel,t=e.nrTracks,n=e.prereleaseUri,a=e.highlightUri,i=e.scrollToIndex,l=e.usePlayContextItem,o=e.hasHeaderRow,u=void 0===o||o,s=e.initalTracks,c=(0,F.r)(O.k,{data:{uri:n}}),d=c.spec,v=c.UBIFragment,f=function(e){var r=(0,h.useContext)(R.j).request,t=(0,h.useCallback)(function(){var t=(0,k.A)(A().mark((function t(n,a){var i,l,o,u,s;return A().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r(w,{uri:e,offset:n,limit:a});case 2:l=t.sent,o=P((null==l||null===(i=l.data)||void 0===i?void 0:i.lookup)||[]),t.prev=4,o.s();case 6:if((u=o.n()).done){t.next=14;break}if("PreReleaseResponseWrapper"!==(s=u.value).__typename){t.next=12;break}if("PreRelease"!==s.data.__typename){t.next=12;break}if(s.data.uri!==e){t.next=12;break}return t.abrupt("return",S(s.data));case 12:t.next=6;break;case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(4),o.e(t.t0);case 19:return t.prev=19,o.f(),t.finish(19);case 22:return t.abrupt("return",T);case 23:case"end":return t.stop()}}),t,null,[[4,16,19,22]])})));return function(e,r){return t.apply(this,arguments)}}(),[r,e]);return t}(n),m=(0,h.useRef)(!1),p=(0,h.useRef)(null),x=(0,h.useState)(null),y=(0,z.A)(x,2),b=y[0],g=y[1],j=(0,h.useCallback)((function(e){return{uri:e.uri}}),[]);(0,h.useEffect)((function(){p.current&&(b?p.current.scrollToIndex(b):i&&p.current.scrollToIndex(i))}),[b,i]);var C=(0,h.useCallback)(function(){var e=(0,k.A)(A().mark((function e(r,t){var n,i;return A().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(r,t);case 2:return n=e.sent,a&&!b&&(i=n.items.findIndex((function(e){return(null==e?void 0:e.uri)===a})),g(i||-1)),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),[f,a,b]),I=(0,h.useCallback)((function(e,r){var t=!m.current&&!!a&&a===e.uri;return t&&(m.current=!0),(0,Y.jsx)(ye.d,{uri:e.uri,isPlayable:e.isPlayable,name:e.name,trackNumber:r+1,index:r,artists:e.artists,playcount:0,contextUri:n,duration_ms:e.hasOriginalAudio?e.durationMs:null,usePlayContextItem:l,isMOGEFRestricted:e.is19PlusOnly,isExplicit:e.isExplicit,shouldHighLight:t,isReleased:e.isPlayable},r+e.uri)}),[a,n,l]);return(0,Y.jsx)(v,{spec:d,children:(0,Y.jsx)(pe.a,{columns:ge,children:(0,Y.jsx)(be.S4,{ariaLabel:r,columns:ge,hasHeaderRow:u,rowPlaceholder:xe.Bz,renderRow:I,resolveItem:j,nrTracks:t,fetchTracks:C,limit:300,tracks:s,outerRef:p,columnPersistenceKey:"album-tracklist"},n)})})}));const je="IVrwmRlzBI3lrWleZGbW",Ae="nPhSYFMXHpfImT4H04k3";var Re=function(e){var r,t,n,x,y,b,k,j,A,R,C,w,P,I,T=e.uri,S=function(e){var r=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:g)({uri:e},{staleTime:3e5,gcTime:36e5}),t=r.data;return{loading:r.loading,error:!!r.error,prerelease:(0,h.useMemo)((function(){if(!t)return null;var r,n=E(t.lookup);try{for(n.s();!(r=n.n()).done;){var a=r.value;if("PreReleaseResponseWrapper"===a.__typename&&"PreRelease"===a.data.__typename&&a.data.uri===e)return D(a.data)}}catch(e){n.e(e)}finally{n.f()}return null}),[t,e])}}(T),_=S.prerelease,L=S.loading,U=S.error,M=function(e){var r,t=null==e||null===(r=e.content)||void 0===r||null===(r=r.coverArt.extractedColors)||void 0===r?void 0:r.hex;return(0,N.z)(t),t}(_),z=parseInt(new URLSearchParams((0,i.zy)().search).get("index")||"0",10),O=(0,c.P)({uri:T,pages:[{items:(I=(null==_||null===(r=_.content)||void 0===r?void 0:r.tracks.items)||[],I.filter((function(e){return e.isPlayable})).map((function(e){return{uri:e.uri,uid:null,type:d.c.TRACK,provider:null}})))}]},{featureIdentifier:"album_prerelease"}).usePlayContextItem;if(L||U||!_)return(0,Y.jsx)(m.A,{hasError:!!U,errorMessage:u.Ru.get("error.not_found.title.album")});if(null!=_&&null!==(t=_.content)&&void 0!==t&&t.uri&&function(e,r){var t;if(null===(t=e.content)||void 0===t||!t.uri||!e.releaseDate)return!1;var n=(0,v.u)(e.releaseDate);return!(n>0)&&n<=-1*r}(_,1728e5)){var B,F=(0,o.cA)(null==_||null===(B=_.content)||void 0===B?void 0:B.uri);if(F)return(0,Y.jsx)(p.$,{to:F.toURLPath(!0)})}return(0,Y.jsxs)("section",{className:je,children:[(0,Y.jsx)(f.Q,{children:u.Ru.get("album.page-title",null!==(n=null===(x=_.content)||void 0===x?void 0:x.name)&&void 0!==n?n:"")}),(0,Y.jsx)(me,{prerelease:_,backgroundColor:M}),(0,Y.jsx)(V,{prerelease:_,backgroundColor:M}),null!==(y=_.content)&&void 0!==y&&y.tracks.totalLength?(0,Y.jsxs)("div",{className:"contentSpacing",children:[(0,Y.jsx)(l.E,{as:"h2",variant:"titleSmall",semanticColor:"textBase",children:u.Ru.get("web-player.prerelease.album_tracklist_preview")}),(0,Y.jsx)(ke,{prereleaseUri:T,ariaLabel:null!==(b=null===(k=_.content)||void 0===k?void 0:k.name)&&void 0!==b?b:u.Ru.get("error.not_found.title.album"),nrTracks:null!==(j=null===(A=_.content)||void 0===A?void 0:A.tracks.totalLength)&&void 0!==j?j:0,scrollToIndex:z,usePlayContextItem:O,initalTracks:null===(R=_.content)||void 0===R?void 0:R.tracks.items,albumUri:null===(C=_.content)||void 0===C?void 0:C.uri})]}):null,(0,Y.jsx)("div",{className:a()(Ae,"contentSpacing"),children:(0,Y.jsx)(s.Z,{copyrights:null!==(w=null===(P=_.content)||void 0===P?void 0:P.copyrights)&&void 0!==w?w:[]})})]})}}}]);
//# sourceMappingURL=xpui-routes-album-prerelease.js.map